(this.webpackJsonpsimulador_horarios=this.webpackJsonpsimulador_horarios||[]).push([[0],{41:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(14),s=n.n(c),u=(n(41),n(13)),i=n.n(u);var o=n(35),d=n(22),b=n(36),j=n(32),l=n(16),p=n(9),f=n.n(p),h=n(6),O=n(8),x=n(4),m=n(33),y=n.n(m),v={base:function(){return"https://api.horarios.bitsys.tech/get?url="},departments:function(){return v.base()+"/departments"},departmentSubjects:function(e){return v.base()+"/department/"+e},subject:function(e){return v.base()+"/class/"+e},subjectShifts:function(e){return v.base()+"/class/i/"+e+"/shifts"}},g=v;function w(e){return i.a.get(g.departmentSubjects(e))}function k(e){return i.a.get(g.subject(e))}function C(e){return i.a.get(g.subjectShifts(e))}var S=f.a.mark(ie),R="[Redux] Init",F="[Redux] Set",L="[Redux] SetYears",A="[Redux] ChangeYear",N="[Redux] GetDepartments",D="[Redux] SetDepartments",I="[Redux] SetDepartment",T="[Redux] GetDepartmentSubjects",M="[Redux] SetSubjects",_="[Redux] AddOrUpdateSubjects",E="[Redux] AddSubjectDone",P="[Redux] RemoveSubject",Y="[Redux] AddOrUpdateShifts",B="[Redux] SaveClass",G="[Redux] RemoveClass",z="[Redux] SetView",H="[Redux] Nothing",J={view:void 0,year:{all:[],chosen:void 0},department:{all:[],chosen:void 0},subject:{all:[],chosen:{}},shifts:{},classes:{},loading:!0},U=Object(l.a)({storage:y.a,key:"simulador-horarios"},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:var n=Object(x.a)({},e);return n[t.payload.name]=t.payload.content,n;case L:var a=Object(x.a)({},e);return a.year=t.payload,a;case A:var r=Object(x.a)({},e);return r.year.chosen=t.payload,r;case N:var c=Object(x.a)({},e);return c.loading=!0,c;case D:var s=Object(x.a)({},e);return s.department=Object(x.a)(Object(x.a)({},e.department),{},{all:t.payload}),s.loading=!1,s;case I:var u=Object(x.a)({},e);return u.department=Object(x.a)(Object(x.a)({},e.department),{},{chosen:t.payload}),u;case T:var i=Object(x.a)({},e);return i.loading=!0,i;case M:var o=Object(x.a)({},e);return o.subject=Object(x.a)(Object(x.a)({},e.subject),{},{all:t.payload}),o.loading=!1,o;case _:var d=Object(x.a)({},e);return d.loading=!0,d;case E:var b=Object(x.a)({},e),j=Object(x.a)({},e.subject.chosen);return j[t.payload.id]=t.payload,b.subject=Object(x.a)(Object(x.a)({},e.subject),{},{chosen:Object(x.a)({},j)}),b;case P:var l=Object(x.a)({},e),p=Object(x.a)({},e.subject.chosen);delete p[t.payload],l.subject=Object(x.a)(Object(x.a)({},e.subject),{},{chosen:Object(x.a)({},p)});var f=Object(x.a)({},e.shifts);return delete f[t.payload],l.shifts=Object(x.a)({},f),l;case Y:var h=Object(x.a)({},e);return h.shifts=Object(x.a)({},e.shifts),h.shifts[t.payload.subject]=t.payload.shifts,h;case B:var O=Object(x.a)({},e),m=Object(x.a)({},e.classes);return m[t.payload.subject]||(m[t.payload.subject]={}),m[t.payload.subject][t.payload.type]||(m[t.payload.subject][t.payload.type]={}),m[t.payload.subject].number=m[t.payload.subject].number?m[t.payload.subject].number+1:1,m[t.payload.subject][t.payload.type][t.payload.number]=Object(x.a)({},e.shifts[t.payload.subject][t.payload.type][t.payload.number]),O.classes=m,O;case G:var y=Object(x.a)({},e),v=Object(x.a)({},e.classes);return delete v[t.payload.subject][t.payload.type][t.payload.number],v[t.payload.subject].count--,v[t.payload.subject].count<=0&&delete v[t.payload.subject],y.classes=v,y;case z:var g=Object(x.a)({},e);return g.view=t.payload,g;default:var w=Object(x.a)({},e);return w.loading=!1,w}})),X=function(){return{type:R}},V=function(e,t){return{type:F,payload:{name:e,content:t}}},q=function(e){return{type:L,payload:e}},K=function(e){return{type:A,payload:e}},Q=function(){return{type:N}},W=function(e){return{type:D,payload:e}},Z=function(e){return{type:I,payload:e}},$=function(e){return{type:M,payload:e}},ee=function(e){return{type:_,payload:e}},te=function(e){return{type:E,payload:e}},ne=function(e){return{type:P,payload:e}},ae=function(e,t){return{type:Y,payload:{subject:e,shifts:t}}},re=function(e,t,n){return{type:B,payload:{subject:e,type:t,number:n}}},ce=function(e,t,n){return{type:G,payload:{subject:e,type:t,number:n}}},se=function(e){return{type:z,payload:e}},ue=function(){return{type:H}};function ie(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)(R,f.a.mark((function e(){var t,n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={all:[],chosen:(new Date).getMonth()>=9?(new Date).getFullYear()+1:(new Date).getFullYear()},n=t.chosen;n>=2015;n--)t.all.push(n);return e.next=4,Object(h.b)(q(t));case 4:return e.next=6,Object(h.b)(Q());case 6:return e.next=8,Object(h.c)((function(e){return e.redux.classes}));case 8:if(a=e.sent,!Array.isArray(a)){e.next=12;break}return e.next=12,Object(h.b)(V("classes",{}));case 12:return e.next=14,Object(h.c)((function(e){return e.redux.view}));case 14:if("chosen"==e.sent){e.next=18;break}return e.next=18,Object(h.b)(V("view",void 0));case 18:case"end":return e.stop()}}),e)})));case 2:return e.next=4,Object(h.d)(N,f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(g.departments());case 2:return t=e.sent,n=t.data,e.next=6,Object(h.b)(W(n));case 6:case"end":return e.stop()}}),e)})));case 4:return e.next=6,Object(h.d)(I,f.a.mark((function e(t){var n,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,e.next=3,w(n);case 3:return a=e.sent,r=a.data,e.next=7,Object(h.b)($(r.classes));case 7:case"end":return e.stop()}}),e)})));case 6:return e.next=8,Object(h.d)(A,f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.payload,e.next=3,Object(h.c)((function(e){return e.redux.subject.chosen}));case 3:return n=e.sent,e.next=6,Object(h.b)(ee(Object.keys(n)));case 6:case"end":return e.stop()}}),e)})));case 8:return e.next=10,Object(h.d)(_,f.a.mark((function e(t){var n,a,r,c,s,u,i,o,d,b,j;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.payload,a=0;case 2:if(!((r=Array.isArray(n)?n[a++]:n)>0)){e.next=22;break}return e.next=6,k(r);case 6:return c=e.sent,s=c.data,u=s,i=s.instances,e.next=12,Object(h.c)((function(e){return e.redux.year.chosen}));case 12:for(o=e.sent,d=!1,b=void 0,j=0;!d&&j<i.length;j++)i[j].year==o&&(b=i[j].id,d=!0);if(!b){e.next=20;break}return e.delegateYield(f.a.mark((function e(){var t,n,a,c,s,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.b)(te(u));case 2:return(t=Object(x.a)({},u)).credits=t.credits/2,delete t.instances,delete t.url,e.next=8,C(b);case 8:return n=e.sent,a=n.data,c=a,s={t:{},to:{},tp:{},tpo:{},p:{},po:{}},e.next=14,w(t.department.id);case 14:return i=e.sent,o=i.data.building.abbreviation,c.map((function(e){var n=Object(x.a)({},e);delete n.teachers,delete n.url;for(var a=0;a<n.instances.length;a++)n.instances[a].duration=n.instances[a].duration/30,n.instances[a].room=n.instances[a].room?o+" "+n.instances[a].room:void 0;var r=e.type_display.indexOf("Te\xf3rico-Pr\xe1tico")>=0?"TP":e.type_display.indexOf("Te\xf3rico")>=0?"T":"P";e.type_display.indexOf("Online")>=0&&(r+="O"),n.type={name:r,title:e.type_display},delete n.type_display,s[r.toLowerCase()][e.number]={subject:t,shift:n}})),e.next=19,Object(h.b)(ae(r,s));case 19:case"end":return e.stop()}}),e)}))(),"t0",18);case 18:e.next=22;break;case 20:return e.next=22,Object(h.b)(ne(r));case 22:if(Array.isArray(n)&&a<=n.length){e.next=2;break}case 23:return e.next=25,Object(h.b)(ue());case 25:case"end":return e.stop()}}),e)})));case 10:case"end":return e.stop()}}),S)}var oe=f.a.mark(be),de=Object(O.c)({redux:U});function be(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)([ie()]);case 2:case"end":return e.stop()}}),oe)}var je=Object(b.a)(),le=[].concat(Object(o.a)(Object(d.b)({immutableCheck:!1,serializableCheck:!1,thunk:!0})),[je]),pe=Object(d.a)({reducer:de,middleware:le,devTools:!1,enhancers:[j.reduxBatch]}),fe=Object(l.b)(pe);je.run(be);var he=pe,Oe=n(7),xe=n(34),me=(n(71),n(72),n(1)),ye=function(e){var t=e.name,n=e.logo,a=e.years,r=e.year,c=e.departments,s=e.department,u=e.subjects,i=e.subject,o=Object(Oe.b)(),d=Object(Oe.c)((function(e){return e.redux.view})),b=function(e){o(K(e))},j=function(e){o(se(e))},l=Object.values(i).sort((function(e,t){return e.abbreviation>t.abbreviation}));return Object(me.jsxs)(me.Fragment,{children:[Object(me.jsxs)("div",{id:"topMenu",children:[Object(me.jsxs)("span",{children:[Object(me.jsx)("img",{src:n}),Object(me.jsx)("h1",{children:t})]}),Object(me.jsxs)("span",{children:[Object(me.jsxs)("select",{value:r,onChange:function(e){return b(e.target.value)},children:[Object(me.jsx)("option",{disabled:!0,selected:!0,children:"Escolher Ano Letivo"}),a.map((function(e){return Object(me.jsx)("option",{value:e,children:e})}))]}),Object(me.jsxs)("select",{value:s,onChange:function(e){return function(e){o(Z(e))}(e.target.value)},children:[Object(me.jsx)("option",{disabled:!0,selected:!0,children:"Escolher Departamento"}),c.map((function(e){return Object(me.jsx)("option",{value:e.id,children:e.name})}))]}),Object(me.jsxs)("select",{onChange:function(e){return function(e){o(ee(e))}(e.target.value)},children:[Object(me.jsx)("option",{value:-1,selected:!0,children:"Adicionar Cadeira"}),u.map((function(e){return i[e.id]?Object(me.jsx)(me.Fragment,{}):Object(me.jsx)("option",{value:e.id,children:e.name})}))]})]})]}),Object(me.jsxs)("div",{id:"subTopMenu",children:[Object(me.jsx)("div",{id:"subjects",children:l.map((function(e){return Object(me.jsxs)("div",{title:e.name,children:[e.abbreviation,Object(me.jsx)("span",{onClick:function(){return function(e){o(ne(e))}(e.id)},children:"X"})]})}))}),Object(me.jsxs)("div",{id:"menu",children:[Object(me.jsx)("div",{className:"option",id:"update",onClick:function(){return b(r)},children:Object(me.jsx)("span",{children:"\u21ba Atualizar"})}),Object(me.jsxs)("div",{id:"view",children:[Object(me.jsx)("span",{className:void 0==d?"active":"",onClick:function(){return j(void 0)},children:"Escolher"}),Object(me.jsx)("span",{className:"chosen"==d?"active":"",onClick:function(){return j("chosen")},children:"Escolhidos"})]})]})]})]})},ve={name:"Simulador de Hor\xe1rios",logo:"./logo.png"},ge=function(){var e=Object(Oe.c)((function(e){return e.redux.year.all})),t=Object(Oe.c)((function(e){return e.redux.year.chosen})),n=Object(Oe.c)((function(e){return e.redux.department.all})),a=Object(Oe.c)((function(e){return e.redux.department.chosen})),r=Object(Oe.c)((function(e){return e.redux.subject.all})),c=Object(Oe.c)((function(e){return e.redux.subject.chosen}));return Object(me.jsx)(ye,{name:ve.name,logo:ve.logo,years:e,year:t,departments:n,department:a,subjects:r,subject:c})},we=(n(74),n(21)),ke=n.n(we),Ce=(n(75),function(e){for(var t=e.times,n=[],a=0;a<t-1;a++)n.push(1);return console.log(n),Object(me.jsxs)(me.Fragment,{children:[n.map((function(e){return Object(me.jsx)("td",{})})),Object(me.jsx)("td",{className:"with-right-border"})]})}),Se=function(e){var t=e.maxClasses,n=e.hours,a=e.classes,r=e.filled,c=e.chosenClasses,s=Object(Oe.b)(),u=function(e,t,n){c[e]&&c[e][t]&&c[e][t][n]?s(ce(e,t,n)):s(re(e,t,n))};return Object(me.jsx)(me.Fragment,{children:Object(me.jsxs)("table",{id:"timetable",className:"timetable",children:[Object(me.jsx)("thead",{children:Object(me.jsxs)("tr",{children:[Object(me.jsx)("th",{children:"Hora"}),Object(me.jsx)("th",{colSpan:t[0],children:"2\xaa"}),Object(me.jsx)("th",{colSpan:t[1],children:"3\xaa"}),Object(me.jsx)("th",{colSpan:t[2],children:"4\xaa"}),Object(me.jsx)("th",{colSpan:t[3],children:"5\xaa"}),Object(me.jsx)("th",{colSpan:t[4],children:"6\xaa"})]})}),Object(me.jsx)("tbody",{children:n.map((function(e){return Object(me.jsxs)("tr",{children:[Object(me.jsxs)("td",{children:[-1==(e/60).toString().indexOf(".5")?parseInt(e/60)<10?"0"+parseInt(e/60):parseInt(e/60):parseInt(e/60)+1<10?"0"+(parseInt(e/60)+1):parseInt(e/60)+1,":00"]}),[0,1,2,3,4].map((function(s){return Object(me.jsxs)(me.Fragment,{children:[r[n.indexOf(e)][s]?a[n.indexOf(e)][s].sort((function(e,t){return e.subject.abbreviation!=t.subject.abbreviation?e.subject.abbreviation>t.subject.abbreviation:e.shift.number>t.shift.number})).map((function(e){return Object(me.jsxs)("td",{rowSpan:e.shift.duration,className:"class ".concat(e.shift.type.name.toLowerCase()," ").concat(e.subject.id,"-").concat(e.shift.type.name.toLowerCase(),"-").concat(e.shift.number),onMouseOver:function(){return t=e.subject.id+"-"+e.shift.type.name.toLowerCase()+"-"+e.shift.number,void ke()("."+t).addClass("hover");var t},onMouseLeave:function(){return t=e.subject.id+"-"+e.shift.type.name.toLowerCase()+"-"+e.shift.number,void ke()("."+t).removeClass("hover");var t},children:[c[e.subject.id]&&c[e.subject.id][e.shift.type.name.toLowerCase()]&&c[e.subject.id][e.shift.type.name.toLowerCase()][e.shift.number]?Object(me.jsx)("div",{className:"save",title:"Remover",onClick:function(){return u(e.subject.id,e.shift.type.name.toLowerCase(),e.shift.number)},children:"X"}):Object(me.jsx)("div",{className:"save",title:"Guardar",onClick:function(){return u(e.subject.id,e.shift.type.name.toLowerCase(),e.shift.number)},children:"\u2605"}),Object(me.jsx)("h3",{children:Object(me.jsx)("span",{title:e.subject.name,children:e.subject.abbreviation})}),Object(me.jsxs)("p",{children:[Object(me.jsxs)("span",{title:e.shift.type.title+" "+e.shift.number,children:[e.shift.type.name," ",e.shift.number]}),Object(me.jsx)("br",{}),e.shift.room]})]})})):Object(me.jsx)(Ce,{times:t[s]-r[n.indexOf(e)][s]}),t[s]>r[n.indexOf(e)][s]&&r[n.indexOf(e)][s]?Object(me.jsx)(Ce,{times:t[s]-r[n.indexOf(e)][s]}):Object(me.jsx)(me.Fragment,{})]})}))]})}))})]})})},Re=function(){for(var e=Object(Oe.c)((function(e){return e.redux.shifts})),t=Object(Oe.c)((function(e){return e.redux.classes})),n=Object(Oe.c)((function(e){return e.redux.view})),a=[],r=8;r<=23.5;r+=.5)a.push(60*r);var c=[],s=[];a.map((function(){var e=[],t=[];[1,2,3,4,5].map((function(){e.push([]),t.push(0)})),c.push(e),s.push(t)}));var u=[1,1,1,1,1],i="chosen"==n?t:e;return Object.keys(i).map((function(e){Object.keys(i[e]).map((function(t){Object.keys(i[e][t]).map((function(n){var r=i[e][t][n];r.shift.instances.map((function(e){c[a.indexOf(e.start)][e.weekday].push({subject:r.subject,shift:Object(x.a)(Object(x.a)({},e),{},{number:r.shift.number,type:r.shift.type})});for(var t=a.indexOf(e.start);t<a.indexOf(e.start)+e.duration;t++)s[t][e.weekday]++,u[e.weekday]=Math.max(u[e.weekday],s[t][e.weekday])}))}))}))})),Object(me.jsx)("div",{id:"content",children:Object(me.jsx)(Se,{maxClasses:u,hours:a,classes:c,filled:s,chosenClasses:t})})},Fe=(n(76),function(){return Object(me.jsx)("div",{className:"loaderContainer",children:Object(me.jsx)("div",{className:"loader"})})}),Le=function(){var e=Object(Oe.b)(),t=Object(Oe.c)((function(e){return e.redux.loading}));return Object(a.useEffect)((function(){e(X())}),[]),Object(me.jsxs)(me.Fragment,{children:[Object(me.jsx)(ge,{}),Object(me.jsx)(Re,{}),t?Object(me.jsx)(Fe,{}):Object(me.jsx)(me.Fragment,{})]})};n(77);var Ae=function(){return i.a,Object(me.jsx)(Oe.a,{store:he,children:Object(me.jsx)(xe.a,{persistor:fe,loading:null,children:Object(me.jsx)(Le,{})})})},Ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,80)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(me.jsx)(r.a.StrictMode,{children:Object(me.jsx)(Ae,{})}),document.getElementById("root")),Ne()}},[[78,1,2]]]);
//# sourceMappingURL=main.be85181d.chunk.js.map